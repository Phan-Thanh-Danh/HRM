@model IEnumerable<HRM.ViewModels.Salary.PayrollRecordVM>

@{
      ViewData["Title"] = "Chi tiết Bảng lương";
      int periodId = ViewBag.PeriodId;
}

<div class="d-flex justify-content-between align-items-center mb-4">
      <h1><i class="bi bi-table"></i> @ViewData["Title"]</h1>
      <div>
            <form asp-action="Lock" asp-route-id="@periodId" method="post" class="d-inline"
                  onsubmit="return confirm('Bạn có chắc chắn muốn chốt bảng lương này? Hành động này không thể hoàn tác.');">
                  <button type="submit" class="btn btn-danger"><i class="bi bi-lock-fill"></i> Chốt sổ lương</button>
            </form>
            <a asp-action="Index" class="btn btn-secondary">Quay lại</a>
      </div>
</div>

<div class="card shadow-sm">
      <div class="card-body">
            <div class="table-responsive">
                  <table class="table table-bordered table-hover align-middle">
                        <thead class="table-light text-center">
                              <tr>
                                    <th>Mã NV</th>
                                    <th>Họ tên</th>
                                    <th>Lương cơ bản</th>
                                    <th>Ngày công</th>
                                    <th>Tổng thu nhập</th>
                                    <th>Tổng khấu trừ</th>
                                    <th>Thuế TNCN</th>
                                    <th>Bảo hiểm</th>
                                    <th>Thực lĩnh</th>
                              </tr>
                        </thead>
                        <tbody>
                              @if (Model != null && Model.Any())
                              {
                                    foreach (var item in Model)
                                    {
                                          <tr>
                                                <td class="text-center">@item.EmployeeId</td>
                                                <td class="fw-bold">@item.EmployeeName</td>
                                                <td class="text-end">@item.BasicSalary.ToString("N0")</td>
                                                <td class="text-center">@item.RealWorkDays</td>
                                                <td class="text-end text-success">@item.TotalEarnings.ToString("N0")</td>
                                                <td class="text-end text-danger">@item.TotalDeductions.ToString("N0")</td>
                                                <td class="text-end">@item.TaxAmount.ToString("N0")</td>
                                                <td class="text-end">@item.InsuranceAmount.ToString("N0")</td>
                                                <td class="text-end fw-bold text-primary">@item.NetSalary.ToString("N0")</td>
                                          </tr>
                                    }
                              }
                              else
                              {
                                    <tr>
                                          <td colspan="9" class="text-center py-4 text-muted">
                                                Chưa có dữ liệu lương. Vui lòng nhấn "Tính lương" ở màn hình danh sách.
                                          </td>
                                    </tr>
                              }
                        </tbody>
                  </table>
            </div>
      </div>
</div>