@model IEnumerable<HRM.ViewModels.Time.AttendanceLogVM>

@{
      ViewData["Title"] = "Lịch sử Chấm công";
      int currentMonth = DateTime.Now.Month;
      if (int.TryParse(Context.Request.Query["month"], out int m))
      {
            currentMonth = m;
      }

      int currentYear = DateTime.Now.Year;
      if (int.TryParse(Context.Request.Query["year"], out int y))
      {
            currentYear = y;
      }
}

<div class="container">
      <div class="d-flex justify-content-between align-items-center mb-4">
            <h1><i class="bi bi-calendar-check"></i> Lịch sử Chấm công</h1>

            <form method="get" class="d-flex gap-2">
                  <select name="month" class="form-select" style="width: auto;">
                        @for (int i = 1; i <= 12; i++)
                        {
                              <!option value="@i" @(i == currentMonth ? "selected" : "")>Tháng @i</!option>
                        }
                  </select>
                  <select name="year" class="form-select" style="width: auto;">
                        @for (int i = 2024; i <= 2030; i++)
                        {
                              <!option value="@i" @(i == currentYear ? "selected" : "")>Năm @i</!option>
                        }
                  </select>
                  <button type="submit" class="btn btn-primary">Xem</button>
            </form>
      </div>

      <div class="card shadow-sm">
            <div class="card-body">
                  <div class="table-responsive">
                        <table class="table table-bordered table-hover text-center align-middle">
                              <thead class="table-light">
                                    <tr>
                                          <th>Ngày</th>
                                          <th>Giờ vào (Check-In)</th>
                                          <th>Giờ ra (Check-Out)</th>
                                          <th>Trạng thái</th>
                                          <th>Ghi chú</th>
                                    </tr>
                              </thead>
                              <tbody>
                                    @if (Model != null && Model.Any())
                                    {
                                          foreach (var item in Model)
                                          {
                                                <tr>
                                                      <td>@item.Date.ToString("dd/MM/yyyy")</td>
                                                      <td>@(item.CheckInTime.HasValue ? item.CheckInTime.Value.ToString("HH:mm") :
                                                "--:--")</td>
                                                            <td>@(item.CheckOutTime.HasValue ? item.CheckOutTime.Value.ToString("HH:mm") :
                                                "--:--")</td>
                                                                  <td>
                                                                        @switch (item.Status.ToString())
                                                                        {
                                                                              case "Present":
                                                                                    <span class="badge bg-success">Đúng giờ</span>
                                                                                    ; break;
                                                                              case "Late":

                                                                                    <span class="badge bg-warning text-dark">Đi muộn</span>
                                                                                    ;
                                                                                    break;
                                                                              case "EarlyLeave":

                                                                                    <span class="badge bg-warning text-dark">Về
                                                                                          sớm</span>
                                                                                          ; break;
                                                case "Absent":

                                                                                                <span class="badge bg-danger">Vắng mặt</span>
                                                                                                ; break;
                                                                                          default:

                                                                                                <span>@item.Status</span>
                                                                                                ; break;
                                                                                          }
                                                                                    </td>
                                                                                    <td>@item.Note</td>
                                                                        </tr>
                                                                  }
                                                            }
                                    else
                                                            {
                                                                  <tr>
                                                                        <td colspan="5" class="text-muted py-4">Không có dữ liệu chấm công trong tháng
                                                                              này.</td>
                                                                        </tr>
                                                                  }
                                                            </tbody>
                                                      </table>
                                                </div>
                                          </div>
                                    </div>

                                    <div class="mt-3">
                                          <a asp-action="Index" class="btn btn-secondary">Quay lại trang Chấm công</a>
                                    </div>
                              </div>