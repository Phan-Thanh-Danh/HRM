@model IEnumerable<HRM.ViewModels.Admin.AssetVM>

@{
      ViewData["Title"] = "Quản lý Tài sản";
}

<div class="d-flex justify-content-between align-items-center mb-4">
      <h1><i class="bi bi-pc-display"></i> @ViewData["Title"]</h1>
      <a asp-action="Create" class="btn btn-primary"><i class="bi bi-plus-lg"></i> Thêm tài sản mới</a>
</div>

<div class="card shadow-sm">
      <div class="card-body">
            <div class="table-responsive">
                  <table class="table table-hover align-middle">
                        <thead class="table-light">
                              <tr>
                                    <th>Mã TS</th>
                                    <th>Tên tài sản</th>
                                    <th>Ngày mua</th>
                                    <th>Giá trị</th>
                                    <th>Người sử dụng</th>
                                    <th>Trạng thái</th>
                                    <th>Thao tác</th>
                              </tr>
                        </thead>
                        <tbody>
                              @foreach (var item in Model)
                              {
                                    <tr>
                                          <td class="fw-bold">@item.Code</td>
                                          <td>@item.Name</td>
                                          <td>@item.PurchaseDate.ToString("dd/MM/yyyy")</td>
                                          <td>@item.PurchasePrice.ToString("N0") VNĐ</td>
                                          <td>@(item.CurrentHolderName ?? "--")</td>
                                          <td>
                                                @switch (item.Status.ToString())
                                                {
                                                      case "Available":
                                                            <span class="badge bg-success">Sẵn sàng</span>
                                                            ; break;
                                                      case "InUse":
                                                            <span class="badge bg-primary">Đang sử dụng</span>
                                                            ; break;
                                                      case "Broken":

                                                            <span class="badge bg-danger">Hỏng</span>
                                                            ; break;
                                                      case "Maintenance":

                                                            <span class="badge bg-warning text-dark">Bảo trì</span>
                                                            ;
                                                            break;
                                                      case "Lost":

                                                            <span class="badge bg-dark">Mất</span>
                                                            ; break;
                                                      default:

                                                            <span>@item.Status</span>
                                                            ; break;
                                                }
                                          </td>
                                          <td>
                                                @if (item.Status == HRM.Models.AssetStatus.Available)
                                                {
                                                      <a asp-action="Assign" asp-route-id="@item.Id" class="btn btn-sm btn-info"
                                                               title="Cấp phát">
                                                            <i class="bi bi-person-plus-fill"></i> Cấp phát
                                                      </a>
                                                }
                                                else if (item.Status == HRM.Models.AssetStatus.InUse)
                                                {
                                                      <form asp-action="Return" asp-route-id="@item.Id" method="post"
                                                            class="d-inline"
                                                            onsubmit="return confirm('Xác nhận thu hồi tài sản này?');">
                                                            <button type="submit" class="btn btn-sm btn-outline-warning"
                                                                    title="Thu hồi">
                                                                  <i class="bi bi-arrow-return-left"></i> Thu hồi
                                                            </button>
                                                      </form>
                                                }
                                          </td>
                                    </tr>
                              }
                        </tbody>
                  </table>
            </div>
      </div>
</div>