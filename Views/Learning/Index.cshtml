@model IEnumerable<HRM.ViewModels.Learning.CourseVM>

@{
      ViewData["Title"] = "Trung tâm Đào tạo";
      var allCourses = ViewBag.AllCourses as IEnumerable<HRM.ViewModels.Learning.CourseVM>;
}

<div class="mb-5">
      <div class="d-flex justify-content-between align-items-center mb-4">
            <h1><i class="bi bi-mortarboard-fill"></i> Khóa học của tôi</h1>
            <a asp-action="CreateCourse" class="btn btn-outline-primary"><i class="bi bi-plus-lg"></i> Quản lý khóa học
                  (Admin)</a>
            </div>

            <div class="row">
                  @if (Model != null && Model.Any())
                  {
                        foreach (var course in Model)
                        {
                              <div class="col-md-4 mb-4">
                                    <div class="card h-100 shadow-sm">
                                          @if (!string.IsNullOrEmpty(course.ThumbnailUrl))
                                          {
                                                <img src="@course.ThumbnailUrl" class="card-img-top" alt="@course.Title"
                                                     style="height: 180px; object-fit: cover;">
                                          }
                                          else
                                          {
                                                <div class="card-img-top bg-light d-flex align-items-center justify-content-center"
                                                           style="height: 180px;">
                                                      <i class="bi bi-book display-4 text-secondary"></i>
                                                </div>
                                          }
                                          <div class="card-body">
                                                <h5 class="card-title">@course.Title</h5>
                                                <div class="progress mb-2" style="height: 10px;">
                                                      <div class="progress-bar bg-success" role="progressbar"
                                                           style="width: @course.Progress%" aria-valuenow="@course.Progress"
                                                           aria-valuemin="0" aria-valuemax="100"></div>
                                                </div>
                                                <small class="text-muted">Hoàn thành: @course.Progress%</small>
                                          </div>
                                          <div class="card-footer bg-white border-top-0">
                                                <a asp-action="Learn" asp-route-id="@course.Id" class="btn btn-primary w-100">
                                                      <i class="bi bi-play-circle"></i> Tiếp tục học
                                                </a>
                                          </div>
                                    </div>
                              </div>
                        }
                  }
                  else
                  {
                        <div class="col-12">
                              <div class="alert alert-info">Bạn chưa đăng ký khóa học nào.</div>
                        </div>
                  }
            </div>
      </div>

      <hr class="my-5" />

      <div class="mb-5">
            <h2 class="mb-4"><i class="bi bi-collection"></i> Tất cả khóa học</h2>
            <div class="row">
                  @if (allCourses != null && allCourses.Any())
                  {
                        foreach (var course in allCourses)
                        {
                              <div class="col-md-3 mb-4">
                                    <div class="card h-100 border-0 shadow-sm hover-shadow transition">
                                          @if (!string.IsNullOrEmpty(course.ThumbnailUrl))
                                          {
                                                <img src="@course.ThumbnailUrl" class="card-img-top rounded-top" alt="@course.Title"
                                                     style="height: 150px; object-fit: cover;">
                                          }
                                          else
                                          {
                                                <div class="card-img-top bg-secondary text-white d-flex align-items-center justify-content-center rounded-top"
                                                           style="height: 150px;">
                                                      <i class="bi bi-award fs-1"></i>
                                                </div>
                                          }
                                          <div class="card-body">
                                                <h6 class="card-title fw-bold">@course.Title</h6>
                                                <p class="card-text small text-muted text-truncate-2">@course.Description</p>
                                                <div class="d-flex justify-content-between align-items-center mt-3">
                                                      <small class="text-muted"><i class="bi bi-journal-text"></i> @course.LessonsCount
                                                            bài học</small>
                                                      </div>
                                                </div>
                                                <div class="card-footer bg-white border-top-0">
                                                      <a asp-action="CourseDetails" asp-route-id="@course.Id"
                                                         class="btn btn-outline-primary btn-sm w-100">Xem chi tiết</a>
                                                </div>
                                          </div>
                                    </div>
                              }
                        }
                  </div>
            </div>